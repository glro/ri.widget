(function(){var i=window.ri=window.ri||{};var h=window.document;var b={style:"style.css",img:{logo:"ri-logo.png",search:"search.png",lake:"lakes.png",investigator:"investigator.png",wait:"wait.gif"}};var k="ri-query-style-sheet";var a={bgColor:"#fff",fgColor:"#333",hlColor:"#55f"};i.widget=function(l){if(h.getElementById(k)==null){h.body.appendChild(c("link",{type:"text/css",href:b.style,rel:"stylesheet",id:k}))}if(typeof l.length!="number"){return new i.widget.SearchForm(f(l,"ri-widget"))}var n=[];for(var m=0;m<l.length;m++){n.push(new i.widget.SearchForm(f(l[m],"ri-widget")))}return n};i.widget.SearchForm=function(n){this.fields=[g("Keyword Search",b.img.search,c("input",{type:"text",name:"query"})),g("Lake or River",b.img.lake,c("select",{name:"lake"},c("option",{value:"all"},j("All Lakes & Rivers")))),g("Investigator",b.img.investigator,c("input",{type:"text",name:"investigator"}))];this.searchForm=c("form",{"class":"ri-query-form",method:"GET"},this.fields.concat([c("input",{type:"submit",name:"search",value:"Search"})]));var r=null;this.searchForm.onsubmit=function(){var s={q:this.query.value};if(this.lake.value!="all"){s.lake=this.lake.value}if(r){n.removeChild(r)}r=c("div",{"class":"result-box"});n.appendChild(r);var u=new i.widget.ResultBox(r,new i.query.pager(s));return false};var t=this;function l(s){return function(){t.select(s);return false}}for(var p=0;p<this.fields.length;p++){var m=this.fields[p].getElementsByTagName("a");var q=l(p);for(var o=0;o<m.length;o++){m[o].onclick=q}}this.select(0);d(n);n.appendChild(c("div",{"class":"ri-widget-search"},[c("img",{src:b.img.logo,"class":"logo",alt:"Search the Research Inventory"}),this.searchForm]))};i.widget.SearchForm.prototype={select:function(m){for(var l=0;l<this.fields.length;l++){this.fields[l].setAttribute("class","field"+(l==m?" selected":""))}}};function g(m,l,n){return c("div",{"class":"field"},[c("a",{href:"#",title:m},[c("img",{src:l}),c("span",null,j(m))]),c("div",{"class":"control"},n)])}i.widget.ResultBox=function(m,l){this.pager=l;d(m);this.wait=m.appendChild(c("div",{"class":"wait"},c("img",{src:b.img.wait})));this.list=m.appendChild(c("ol",{"class":"list"}));this.pglist=m.appendChild(c("ul",{"class":"pager"}));m.setAttribute("class","ri-widget-results");var n=this;l.subscribe("switch",function(o){n.wait.style.display="block"});l.subscribe("change",function(){n.update();n.wait.style.display="none"});if(l.ready){l.switchPage(1)}};i.widget.ResultBox.prototype={page:function(l){if(l==undefined){return this.page}},update:function(){d(this.list);this.list.setAttribute("start",""+((this.pager.page-1)*this.pager.pageSize+1));var m=this.pager.getProjects();for(var l=0;l<m.length;l++){var n=m[l];this.list.appendChild(c("li",null,c("a",{href:n.url,target:"_blank"},j(n.title))))}d(this.pglist);for(var l=1;l<=this.pager.pageCount;l++){(function(q){var o=this.pager,p=c("a",{href:"#","class":(q==o.page?"selected page-num":"page-num")},j(q));p.onclick=function(){o.switchPage(q);return false};this.pglist.appendChild(c("li",null,p))}).call(this,l)}}};function e(l){return Object.prototype.toString.call(l)=="[object Array]"}function c(l,p,o){p=p||{};o=o?(e(o)?o:[o]):[];var r=h.createElement(l);for(var m in p){r.setAttribute(m,p[m])}for(var q=0;q<o.length;q++){r.appendChild(o[q])}return r}function j(l){return h.createTextNode(""+l)}function d(m,l){while(l=m.firstChild){m.removeChild(l)}}function f(q,p){var l=q.attributes["class"],o=l?l.nodeValue:"";var m=new RegExp("(^|s)"+p+"($|s)");if(!m.test(o)){o+=" "+p}q.setAttribute("class",o);return q}})();